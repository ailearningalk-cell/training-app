<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Training Programs â€“ July 2025</title>
  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Inter, sans-serif;
      background: #f9fafb;
      color: #111;
    }

    .wrap {
      max-width: 1200px;
      margin: 30px auto;
      padding: 0 16px;
    }

    .title {
      font-size: 1.6em;
      font-weight: 600;
      text-align: center;
      margin-bottom: 20px;
    }

    .card {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      padding: 16px;
      overflow-x: auto; /* allow scroll only if table is larger than screen */
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    th, td {
      padding: 10px;
      border: 1px solid #e5e7eb;
    }

    th {
      background: #f3f4f6;
      font-weight: 600;
      text-align: center; /* all headers centered */
    }

    /* center-align certain columns */
    td.center {
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="title">Training Programs in July-2025</div>
    <div class="card">
      <table id="grid">
        <thead id="thead"></thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </div>

  <script>
    // === CONFIG: your sheet ===
    const SHEET_ID = "1jOq4rQC2m6MCw4wyAyaIIY5CNESMO4HwkJ49h6WD-VY";
    const GID = "458904660";
    const GVIZ_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?gid=${GID}&tqx=out:json`;

    async function loadSheet() {
      try {
        const r = await fetch(GVIZ_URL);
        const text = await r.text();
        const json = JSON.parse(text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1));
        const table = json.table;

        const columns = table.cols.map(c => c.label || c.id || "");
        const rows = table.rows
          .map(r => (r.c || []).map(cell => cell ? (cell.f ?? cell.v ?? "") : ""))
          .filter(r => r.some(v => v !== ""));

        render(columns, rows);
      } catch (e) {
        console.error(e);
      }
    }

    function render(columns, rows) {
      const thead = document.getElementById("thead");
      const tbody = document.getElementById("tbody");

      // Render header row
      thead.innerHTML = "";
      const tr = document.createElement("tr");
      columns.forEach(col => {
        const th = document.createElement("th");
        th.textContent = col;
        tr.appendChild(th);
      });
      thead.appendChild(tr);

      // Render body rows
      tbody.innerHTML = "";
      rows.forEach(row => {
        const tr = document.createElement("tr");
        row.forEach((val, i) => {
          const td = document.createElement("td");
          td.textContent = val;

          // Center align certain columns
          const colName = columns[i].toLowerCase();
          if (["sl. no", "no of participants", "duration", "remarks"].some(name => colName.includes(name))) {
            td.classList.add("center");
          }

          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
    }

    loadSheet();
  </script>
</body>
</html>
