<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Today's Trainings</title>
  <style>
    body { font-family: Arial, sans-serif; margin:20px; background:#f7fafc; color:#111 }
    h1 { margin-bottom:12px; }
    table { border-collapse: collapse; width:100%; background:#fff; box-shadow:0 2px 4px rgba(0,0,0,0.1); }
    th, td { border:1px solid #ddd; padding:8px; text-align:left; }
    th { background:#2193b0; color:#fff; }
    tr:nth-child(even) td { background:#f9f9f9; }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>
<body>
  <h1 id="heading">Training</h1>
  <div id="tableArea">Loadingâ€¦</div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR9rXqiV3oCIIuwRc1nXgwJ4DbYvtwsEAsPAbxUPWwzf_VYGnyJAhCL4TWn4LYs5TiDo13foTLTpY_g/pub?gid=1229350699&single=true&output=csv";

function norm(c){ return String(c||"").replace(/\u00A0/g,' ').trim(); }

async function loadSheet(){
  const res = await fetch(CSV_URL);
  const text = await res.text();
  const parsed = Papa.parse(text, {header:false, skipEmptyLines:true});
  const rows = parsed.data.map(r=>r.map(norm));

  // Row1 = today's date
  const todayCell = rows[0][0] || "";
  document.getElementById("heading").textContent = `Training on ${todayCell}`;

  // Row3 = headers, Row4+ = data
  const headers = rows[2];
  const data = rows.slice(3);

  // If first row of data contains "There is no training today"
  if (data.length && data[0][0].toLowerCase().includes("there is no training")) {
    document.getElementById("tableArea").innerHTML = "<p>No training today.</p>";
    return;
  }

  // Build HTML table
  let html = "<table><thead><tr>";
  headers.forEach(h => { html += `<th>${h}</th>`; });
  html += "</tr></thead><tbody>";

  data.forEach(r => {
    if (r.every(cell => cell==="")) return; // skip blank
    html += "<tr>" + r.map(c => `<td>${c}</td>`).join("") + "</tr>";
  });

  html += "</tbody></table>";
  document.getElementById("tableArea").innerHTML = html;
}

loadSheet();
</script>
</body>
</html>
